{
  "diagram_data": "{\"name\":\"test\",\"project_id\":\"fbfeeee4-ad1b-478b-b6e3-d812bd9a901d\",\"workflow_relationships\":[{\"version\":\"1.0.0\",\"node\":\"230ab190-7b9b-4f6c-a992-c352a6e32682\",\"name\":\"then\",\"type\":\"then\",\"next\":\"8e072088-987a-4dd7-8b3e-c106c0403b6b\",\"expression\":\"\",\"id\":\"ae52dfd9-36dd-4baa-8cc7-b9787e9f1e2e\"},{\"version\":\"1.0.0\",\"node\":\"8e072088-987a-4dd7-8b3e-c106c0403b6b\",\"name\":\"then\",\"type\":\"then\",\"next\":\"20ed0e8c-80d5-4560-8637-0d8352134f73\",\"expression\":\"\",\"id\":\"3c26d9dd-199e-4cf9-bda6-fa99d3919539\"}],\"workflow_states\":[{\"id\":\"cd42366c-d9c5-4209-99b5-1ca06a94d34a\",\"name\":\"Untitled Code Block\",\"version\":\"1.0.0\",\"type\":\"lambda\",\"language\":\"nodejs8.10\",\"code\":\"\\nasync function main(blockInput, backpack) {\\n    return 'Hello World!';\\n}\\n\",\"memory\":768,\"libraries\":[],\"layers\":[],\"max_execution_time\":900,\"environment_variables\":{},\"reserved_concurrency_count\":false},{\"id\":\"0cd20f20-c676-40b9-a9f9-652e2c53b6b1\",\"name\":\"Clone Repository and Find Secrets\",\"version\":\"1.0.0\",\"type\":\"lambda\",\"language\":\"python3.6\",\"code\":\"from git import Repo\\n\\nimport os\\nimport base64\\nimport tempfile\\nimport shutil\\nimport logging\\n\\nfrom secret_scan import scan_file_for_secrets\\n\\nlogging.basicConfig(level=logging.DEBUG)\\n\\ndef find_secrets_in_repo(repo_dir):\\n    for root, _, files in os.walk(repo_dir):\\n        if '.git' in root:\\n            continue\\n\\n        for name in files:\\n            repo_file = os.path.join(root, name)\\n\\n            # TODO enforce maximum file size? or split up into two files\\n\\n            for found_secret in scan_file_for_secrets(repo_file):\\n                yield found_secret\\n\\ndef serialize_obj(obj):\\n    found_secret_dict = obj.__dict__\\n    found_secret_dict['secret_type'] = str(found_secret_dict['secret_type'])\\n    found_secret_dict['secret_hash'] = base64.b64encode(found_secret_dict['secret_hash']).decode()\\n    return found_secret_dict\\n\\ndef main(block_input, backpack):\\n    git_url = block_input['git_url']\\n\\n    with tempfile.TemporaryDirectory() as repo_dir:\\n        # TODO go through different branches?\\n        Repo.clone_from(git_url, repo_dir, branch='master')\\n\\n        return [serialize_obj(s) for s in find_secrets_in_repo(repo_dir)]\\n\",\"memory\":768,\"libraries\":[\"gitpython\"],\"layers\":[\"arn:aws:lambda:us-west-2:917214244454:layer:git-lambda2_TfG3UytU:1\"],\"max_execution_time\":900,\"environment_variables\":{},\"reserved_concurrency_count\":false,\"saved_block_metadata\":{\"added_timestamp\":1585245054551,\"timestamp\":1584737951,\"version\":0,\"id\":\"9ceda978-2605-41fb-a710-37fb76a425cd\"}},{\"id\":\"d029fb56-ca2b-4ea3-8f2f-1fd438c1416b\",\"name\":\"Save Secret\",\"version\":\"1.0.0\",\"type\":\"lambda\",\"language\":\"python3.6\",\"code\":\"\\ndef main(block_input, backpack):\\n    return \\\"Hello World!\\\"\\n\",\"memory\":768,\"libraries\":[\"boto3\"],\"layers\":[],\"max_execution_time\":900,\"environment_variables\":{},\"reserved_concurrency_count\":false,\"saved_block_metadata\":{\"added_timestamp\":1585245064025,\"timestamp\":1584737951,\"version\":0,\"id\":\"a19a8e42-1019-4ed5-8de3-6e2b7f289543\"}},{\"id\":\"23973297-6814-419d-8a28-cdde08695e44\",\"name\":\"Untitled Timer Block\",\"version\":\"1.0.0\",\"type\":\"schedule_trigger\",\"description\":\"Deployed by Refinery\",\"input_string\":\"\",\"schedule_expression\":\"rate(2 minutes)\"},{\"id\":\"230ab190-7b9b-4f6c-a992-c352a6e32682\",\"name\":\"Untitled API Endpoint Block\",\"version\":\"1.0.0\",\"type\":\"api_endpoint\",\"api_path\":\"/replaceme/dawngemturner\",\"http_method\":\"GET\"},{\"id\":\"20ed0e8c-80d5-4560-8637-0d8352134f73\",\"name\":\"API Endpoint Response Block\",\"version\":\"1.0.0\",\"type\":\"api_gateway_response\"},{\"id\":\"8e072088-987a-4dd7-8b3e-c106c0403b6b\",\"name\":\"Untitled Code Block\",\"version\":\"1.0.0\",\"type\":\"lambda\",\"language\":\"nodejs8.10\",\"code\":\"\\nasync function main(blockInput, backpack) {\\n    return 'Hello World!';\\n}\\n\",\"memory\":768,\"libraries\":[],\"layers\":[],\"max_execution_time\":900,\"environment_variables\":{},\"reserved_concurrency_count\":false},{\"id\":\"50339391-e24e-4565-ba9b-02ff0d108740\",\"name\":\"Untitled Topic Block\",\"version\":\"1.0.0\",\"type\":\"sns_topic\"},{\"id\":\"e1dd17cb-0450-4d8f-bb89-f312b797f5d0\",\"name\":\"Untitled Queue Block\",\"version\":\"1.0.0\",\"type\":\"sqs_queue\",\"batch_size\":1}],\"workflow_files\":[],\"workflow_file_links\":[],\"version\":1,\"readme\":\"# Untitled Project README\\n\\nThis is a Refinery project README, update it to explain more about the project.\"}",
  "project_config": {
    "environment_variables": {},
    "api_gateway": {
      "gateway_id": "o3vsp91enc"
    },
    "version": "1.0.0",
    "logging": {
      "level": "LOG_ALL"
    },
    "warmup_concurrency_level": 0
  },
  "project_id": "fbfeeee4-ad1b-478b-b6e3-d812bd9a901d",
  "project_name": "test"
}